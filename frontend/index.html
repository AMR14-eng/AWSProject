<!-- frontend/index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LabCloud - Laboratorios</title>
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@5.2.11/dist/amazon-cognito-identity.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- PANTALLA DE LOGIN -->
    <div id="loginScreen" class="login-container">
        <h1>üî¨ LabCloud</h1>
        <p>Sistema de Gesti√≥n de Laboratorios</p>
        
        <form id="loginForm">
            <div class="form-group">
                <label for="username">Usuario:</label>
                <input type="text" id="username" required placeholder="user@laba.com">
            </div>
            
            <div class="form-group">
                <label for="password">Contrase√±a:</label>
                <input type="password" id="password" required placeholder="Tu contrase√±a">
            </div>
            
            <button type="submit">Iniciar Sesi√≥n</button>
        </form>
        
        <div id="loginError" class="error hidden"></div>
    </div>
    
    <!-- Bot√≥n de registro despu√©s del login -->
    <div id="registerPrompt" class="register-prompt">
        <p>¬øNuevo Laboratorio?</p>
        <button onclick="showRegister()" class="register-btn">Registrarse</button>
    </div>

    <!-- PANTALLA DE CAMBIO DE CONTRASE√ëA -->
    <div id="changePasswordScreen" class="login-container password-change-screen hidden">
        <h3>üîê Cambio de Contrase√±a Requerido</h3>
        <p class="password-change-alert">
            <strong id="currentChangingUser">user@laba.com</strong> - Es tu primer acceso. Debes cambiar tu contrase√±a temporal.
        </p>
        
        <div class="form-group">
            <label for="newPassword"><strong>Nueva Contrase√±a:</strong></label>
            <input type="password" id="newPassword" required 
                placeholder="M√≠nimo 8 caracteres, con may√∫sculas, min√∫sculas y n√∫meros"
                class="new-password-input">
            <small class="password-hint">
                üîí La contrase√±a debe tener al menos 8 caracteres, incluir may√∫sculas, min√∫sculas y n√∫meros.
            </small>
        </div>
        
        <button onclick="completeNewPassword()" class="confirm-password-btn">
            ‚úÖ Establecer Nueva Contrase√±a
        </button>
        
        <div id="changePasswordError" class="error hidden" style="margin-top: 15px;"></div>
    </div>

    <!-- PANTALLA DE REGISTRO -->
    <div id="registerScreen" class="login-container hidden">
        <h1>üìã Registro de Nuevo Laboratorio</h1>
        <p>Complete el formulario para crear su cuenta</p>
        
        <form id="registerForm">
            <div class="form-group">
                <label for="companyName">Nombre del Laboratorio/Cl√≠nica:</label>
                <input type="text" id="companyName" required placeholder="Ej: Laboratorio Central">
            </div>
            
            <div class="form-group">
                <label for="contactName">Nombre del Contacto:</label>
                <input type="text" id="contactName" required placeholder="Ej: Juan P√©rez">
            </div>
            
            <div class="form-group">
                <label for="registerEmail">Correo Electr√≥nico:</label>
                <input type="email" id="registerEmail" required placeholder="admin@laboratorio.com">
            </div>
            
            <div class="form-group">
                <label for="phone">Tel√©fono:</label>
                <input type="tel" id="phone" placeholder="+1 (234) 567-8900">
            </div>
            
            <div class="form-group">
                <label for="subscriptionTier">Plan de Suscripci√≥n:</label>
                <select id="subscriptionTier" required>
                    <option value="">Seleccione un plan</option>
                    <option value="basic">Basic ($99/mes)</option>
                    <option value="professional" selected>Professional ($299/mes)</option>
                    <option value="enterprise">Enterprise ($599/mes)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="terms" required>
                    Acepto los <a href="#" onclick="showTerms()">t√©rminos y condiciones</a>
                </label>
            </div>
            
            <button type="submit" id="registerBtn" class="register-submit-btn">Registrarse</button>
            <button type="button" onclick="showLogin()" class="back-btn">Volver al Login</button>
        </form>
        
        <div id="registerResult" class="hidden"></div>
        <div id="registerError" class="error hidden"></div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="hidden">
        <div class="nav">
            <h2>LabCloud - <span id="tenantName"></span></h2>
            <button onclick="logout()" class="logout-btn">Cerrar Sesi√≥n</button>
        </div>

        <!-- Secci√≥n de Resultados -->
        <div class="dashboard-section">
            <h3>Resultados de Laboratorio</h3>
            <div class="form-group">
                <label for="patientId">Buscar por ID de Paciente:</label>
                <div class="search-container">
                    <input type="text" id="patientId" placeholder="ID del paciente">
                    <button onclick="searchResults()" class="search-btn">Buscar</button>
                </div>
            </div>
            <div id="resultsList"></div>
        </div>

        <!-- Secci√≥n de Facturaci√≥n -->
        <div id="billingSection" class="dashboard-section hidden">
            <h3>üí∞ Facturaci√≥n y Uso</h3>
            <div class="form-group">
                <button onclick="loadBillingInfo()" class="action-btn">Ver Factura Actual</button>
                <button onclick="loadUsageHistory()" class="action-btn secondary">Historial de Uso</button>
            </div>
            <div id="billingInfo"></div>
            <div id="usageHistory" class="hidden"></div>
        </div>

        <!-- Secci√≥n para Crear Resultados -->
        <div id="createResultSection" class="dashboard-section hidden">
            <h3>‚ûï Crear Nuevo Resultado</h3>
            <div class="form-group">
                <label for="newPatientId">ID del Paciente:</label>
                <input type="text" id="newPatientId" placeholder="Paciente ID">
            </div>
            
            <div class="form-group">
                <label for="testCode">C√≥digo de Prueba:</label>
                <input type="text" id="testCode" placeholder="Ej: CBC, GLUCOSE, COVID">
            </div>
            
            <div class="form-group">
                <label for="testData">Datos de la Prueba (JSON):</label>
                <textarea id="testData" rows="4" placeholder='{"glucose": 95, "units": "mg/dL", "status": "normal"}'></textarea>
                <small class="form-hint">Formato JSON v√°lido</small>
            </div>
            
            <button onclick="createLabResult()" class="action-btn">Crear Resultado</button>
            <div id="createResultStatus"></div>
        </div>

        <!-- Secci√≥n de Subir Archivo -->
        <div class="dashboard-section">
            <h3>Subir Archivo</h3>
            <div class="form-group">
                <input type="file" id="fileInput" class="file-input">
            </div>
            <button onclick="uploadFile()" class="action-btn">Subir Archivo</button>
            <div id="uploadStatus"></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>